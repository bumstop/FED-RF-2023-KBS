<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <title>큰 이미지 마우스무브 이동뷰어</title>
        <style>
            html,
            body {
                margin: 0;
                padding: 0;
                width: 100%;
                height: 100%;
                overflow: hidden;
            }

            /*부모박스*/
            #wrap {
                position: relative;
                /*부모자격*/
                width: 100%;
                height: 100%;
            }

            /*이미지박스*/
            #imgbox {
                position: absolute;
                width: 3000px;
                height: 1999px;
                background: url(images/city.jpg) no-repeat;
                /*트랜지션*/
                transition: all 2s ease-out;
            }

            /*마우스무브 처리용 커버박스*/
            #cover {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
            }
        </style>
        <script src="js/jquery-1.8.1.min.js"></script>
        <script src="js/jquery-ui-1.10.4.min.js"></script>
        <script>
            $(() => {
                ////////// jQB ///////////////

                /* 요구사항:
                화면범위에서 마우스 포인터가 움직일때 큰 이미지박스가
                범위안에서 비율에 맞게 애니메이션되며 위치이동함
            */

                // 1. 대상선정
                // 1-1. 이벤트대상: #cover
                const cover = $("#cover");
                // 1-2. 변경대상: #imgbox
                const imgBox = $("#imgbox");

                // 2. 이미지박스 정중앙 위치 구하기
                // 2-1. 중앙위치 top값: (윈도우 높이 - 이미지박스 높이) / 2
                let cTop = ($(window).height() - imgBox.height()) / 2;
                // 2-2. 중앙위치 left값: (윈도우 넓이 - 이미지박스 넓이) / 2
                let cLeft = ($(window).width() - imgBox.width()) / 2;

                // 3. 이미지박스 중앙위치 반영하기
                imgBox.css({
                    top: cTop + "px",
                    left: cLeft + "px",
                });

                // 4. 이미지박스 움직일 값을 위한 비례식 만들기
                // 마우스 최대값 : 마우스 이동값 = 이미지 최대값 : 이미지 이동값 ->
                // 마우스 최대값 * 이미지 이동값 = 마우스 이동값 * 이미지 최대값 ->
                // 이미지 이동값 = 마우스 이동값 * 이미지 최대값 / 마우스 최대값

                // 4-1. 이미지 최대 이동값 구하기 : top / left
                let iTopMax = $(window).height() - imgBox.height();
                let iLeftMax = $(window).width() - imgBox.width();
                // 4-2. 마우스 최대 이동값 구하기 : top / left
                let mTopMax = $(window).height();
                let mLeftMax = $(window).width();

                // console.log(
                //     "이미지 최대 이동값top:", iTopMax, "left:", iLeftMax, 
                //     "마우스 최대 이동값top:" ,mTopMax, "left:", mLeftMax
                // );
                
                // 이벤트 대상 #cover -> cover 변수
                cover.mousemove((e) => {
                    // 1. 마우스 이동값 구하기
                    mPosX = e.pageX;
                    mPosY = e.pageY;

                    // 2. 비례식 적용하기
                    // 이미지 이동값 = 마우스 이동값 * 이미지 최대값 / 마우스 최대값
                    // 이미지 X축 이동값
                    let iPosX = mPosX * iLeftMax / mLeftMax;
                    // 이미지 Y축 이동값
                    let iPosY = mPosY * iTopMax / mTopMax;

                    console.log('최종위치:', iPosX, '/', iPosY);

                    // 3. 실제 이미지 위치이동 적용하기
                    // 대상: .imgbox -> imgBox 변수
                    imgBox.css({
                        top: iPosY + "px",
                        left: iPosX + "px"
                    });
                });


            }); ////////// jQB ///////////////
        </script>
    </head>
    <body>
        <!--전체부모박스-->
        <div id="wrap">
            <div id="imgbox"></div>
            <div id="cover"></div>
        </div>
    </body>
</html>
